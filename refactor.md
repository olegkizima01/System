# –¢–µ—Ö–Ω—ñ—á–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è (–¢–ó): –ü–µ—Ä–µ—Ö—ñ–¥ Trinity Runtime –¥–æ –≥—ñ–±—Ä–∏–¥–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º native API —Ç–∞ fallback –Ω–∞ low-level GUI automation

## –ú–µ—Ç–∞ –∑–º—ñ–Ω
–ü–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–¥–∞—á —É Project Atlas (Trinity Graph Runtime) –Ω–∞ **–≥—ñ–±—Ä–∏–¥–Ω—É –º–æ–¥–µ–ª—å**, –¥–µ:
- –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—Ä–æ–∫—ñ–≤ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ **native/macOS API** (AppleScript, Shortcuts, shell –¥–µ –¥–æ—Ü—ñ–ª—å–Ω–æ).
- –ü—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ native-—à–ª—è—Ö—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ **low-level GUI automation** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–±–º–µ–∂–µ–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ (–∫–ª—ñ–∫ –º–∏—à—ñ, –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É, –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω—É, OCR).
- –ó–Ω–∞—á–Ω–æ –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –≤–µ–ª–∏–∫–æ–≥–æ –Ω–∞–±–æ—Ä—É —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö tool-—ñ–≤, —â–æ –∑–º–µ–Ω—à–∏—Ç—å –≥–∞–ª—é—Ü–∏–Ω–∞—Ü—ñ—ó —Ç–∞ –ø–æ–º–∏–ª–∫–∏ "tool –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ".

## –û–±—Å—è–≥ —Ä–æ–±—ñ—Ç

### 1. –î–æ–¥–∞—Ç–∏/–æ–Ω–æ–≤–∏—Ç–∏ –Ω–∞–±—ñ—Ä low-level GUI tools (–≤ `core/mcp.py`)
–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–±–æ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ (–Ω–∞ –±–∞–∑—ñ Accessibility API macOS):

| Tool name                | –û–ø–∏—Å                                                                 | –ü–∞—Ä–∞–º–µ—Ç—Ä–∏                                      | –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç |
|--------------------------|----------------------------------------------------------------------|------------------------------------------------|-----------|
| `move_mouse`             | –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –∫—É—Ä—Å–æ—Ä –º–∏—à—ñ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏                       | x: int, y: int                                 | –í–∏—Å–æ–∫–∏–π   |
| `click_mouse`            | –ö–ª—ñ–∫ –º–∏—à—ñ (–ª—ñ–≤–∏–π, –ø—Ä–∞–≤–∏–π, –ø–æ–¥–≤—ñ–π–Ω–∏–π)                                 | button: "left"|"right"|"double", modifiers?    | –í–∏—Å–æ–∫–∏–π   |
| `type_text`              | –í–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –∑ —ñ–º—ñ—Ç–∞—Ü—ñ—î—é –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏                                  | text: str, clear_first: bool = False           | –í–∏—Å–æ–∫–∏–π   |
| `press_key`              | –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –∫–ª–∞–≤—ñ—à—É –∞–±–æ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é                          | key: str (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "return", "cmd+c")         | –°–µ—Ä–µ–¥–Ω—ñ–π  |
| `capture_screen_region`  | –ó–∞—Ö–æ–ø–∏—Ç–∏ —Å–∫—Ä—ñ–Ω—à–æ—Ç —Ä–µ–≥—ñ–æ–Ω—É (—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ `capture_screen`)    | x, y, width, height                            | –í–∏—Å–æ–∫–∏–π   |
| `ocr_region`             | –†–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ç–µ–∫—Å—Ç —É —Ä–µ–≥—ñ–æ–Ω—ñ –µ–∫—Ä–∞–Ω—É (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Vision Framework –∞–±–æ Apple Intelligence on-device OCR) | x, y, width, height ‚Üí str | –í–∏—Å–æ–∫–∏–π   |
| `find_image_on_screen`   | –ü–æ—à—É–∫ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (—à–∞–±–ª–æ–Ω—É) –Ω–∞ –µ–∫—Ä–∞–Ω—ñ –∑ tolerance (–¥–ª—è vision-based click) | template_path: str –∞–±–æ base64, tolerance: float | –°–µ—Ä–µ–¥–Ω—ñ–π  |

> –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `pyobjc` + `Accessibility` –∞–±–æ `AppKit`/`CoreGraphics` –¥–ª—è –º–∏—à—ñ/–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏. –î–ª—è OCR ‚Äî `Vision.framework` —á–µ—Ä–µ–∑ pyobjc.

### 2. –†–æ–∑—à–∏—Ä–∏—Ç–∏/–æ–Ω–æ–≤–∏—Ç–∏ native tools
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –∑–∞–ª–∏—à–∏—Ç–∏/–¥–æ–¥–∞—Ç–∏ –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤—ñ native —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:
- `run_applescript` (–≤–∂–µ —î) ‚Äî —Ä–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤ unsafe_mode.
- `run_shortcut` ‚Äî –Ω–æ–≤–∏–π tool –¥–ª—è –∑–∞–ø—É—Å–∫—É Shortcuts —á–µ—Ä–µ–∑ URL scheme (`shortcuts://run-shortcut?name=...`).
- `open_url` / `open_app` ‚Äî –ø—Ä–æ—Å—Ç—ñ native –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏.

### 3. –ó–º—ñ–Ω–∏—Ç–∏ –ª–æ–≥—ñ–∫—É Tetyana node (`_tetyana_node` –≤ `core/trinity.py`)
–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ **–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**:

1. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫—Ä–æ–∫ —á–µ—Ä–µ–∑ **native/high-level tools** (run_applescript, run_shortcut —Ç–æ—â–æ).
2. –Ø–∫—â–æ –∫—Ä–æ–∫ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏–π native (–Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ tool –∞–±–æ tool –ø–æ–≤–µ—Ä–Ω—É–≤ –ø–æ–º–∏–ª–∫—É "–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è") ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **GUI fallback**.
3. –£ GUI-—Ä–µ–∂–∏–º—ñ Tetyana –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ª–∏—à–µ low-level tools + vision (capture ‚Üí ocr ‚Üí plan next action).

–î–æ–¥–∞—Ç–∏ –≤ –ø—Ä–æ–º–ø—Ç Tetyana —è–≤–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é:
```
–°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∂–¥–∏ —à—É–∫–∞–π native —Å–ø–æ—Å—ñ–± (AppleScript, Shortcuts, URL schemes).
–Ø–∫—â–æ native –Ω–µ–º–æ–∂–ª–∏–≤–∏–π ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π GUI automation: —Å–ø–æ—á–∞—Ç–∫—É capture/ocr –¥–ª—è –æ—Ä—ñ—î–Ω—Ç–∞—Ü—ñ—ó, –ø–æ—Ç—ñ–º move/click/type.
–ù—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–≥–∞–¥—É–π –Ω–µ—ñ—Å–Ω—É—é—á—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏.
```

### 4. –†–æ–∑—à–∏—Ä–∏—Ç–∏ Grisha node (`_grisha_node`) –¥–ª—è vision verification
- –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ GUI-–∫—Ä–æ–∫—É –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ —Ä–æ–±–∏—Ç–∏ `capture_screen_region` + OCR –¥–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
- Grisha –≤–∏—Ä—ñ—à—É—î: —á–∏ –¥–æ—Å—è–≥–Ω—É—Ç–æ –º–µ—Ç–∏, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏/–≤–∏–ø—Ä–∞–≤–∏—Ç–∏.

### 5. –û–Ω–æ–≤–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –¥–æ–∑–≤–æ–ª—ñ–≤
- Low-level GUI tools (move_mouse, click_mouse, type_text —Ç–æ—â–æ) ‚Äî –≤–≤–∞–∂–∞—Ç–∏ **–Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–º–∏** —ñ –±–ª–æ–∫—É–≤–∞—Ç–∏ –≤ safe mode (–≤–∏–º–∞–≥–∞—é—Ç—å CONFIRM_* –∞–±–æ ui_unsafe_mode=ON).
- –î–æ–¥–∞—Ç–∏ –æ–∫—Ä–µ–º–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –¥–ª—è "GUI automation mode" –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥—ñ –≤ fallback.

### 6. –û–Ω–æ–≤–∏—Ç–∏ TUI/CLI —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–î–æ–¥–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏:
- `/gui_mode status|on|off|auto` ‚Äî –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–µ–∂–∏–º–æ–º (–∞–≤—Ç–æ = –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç native + fallback).
- –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ –ª–æ–≥–∞—Ö: —á—ñ—Ç–∫–æ –ø–æ–∑–Ω–∞—á–∞—Ç–∏ "Native execution" vs "GUI fallback".

### 7. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ smoke tests (–¥–æ–¥–∞—Ç–∏ –¥–æ Test Plan)
- Native: "–í—ñ–¥–∫—Ä–∏–π google.com –≤ Safari" ‚Üí –º–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ run_applescript.
- Fallback: "–ö–ª—ñ–∫–Ω–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, —è–∫–æ—ó –Ω–µ–º–∞—î –≤ AppleScript" (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ –Ω–µ—Å—É–º—ñ—Å–Ω–æ–º—É app) ‚Üí –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ GUI.
- Vision loop: "–ó–Ω–∞–π–¥–∏ —ñ–∫–æ–Ω–∫—É Finder –Ω–∞ Dock —ñ –∫–ª—ñ–∫–Ω–∏" ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î find_image_on_screen –∞–±–æ OCR.
- –ë–µ–∑–ø–µ–∫–∞: –í safe mode —Å–ø—Ä–æ–±–∞ GUI ‚Üí –ø–∞—É–∑–∞ –∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º.

## –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—î **—É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ—é** ‚Äî –ø—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º macOS-–¥–æ–¥–∞—Ç–∫–æ–º.
- –ó–Ω–∞—á–Ω–æ –º–µ–Ω—à–µ –≥–∞–ª—é—Ü–∏–Ω–∞—Ü—ñ–π tool-—ñ–≤.
- –í–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–¥–∞—á ‚Äî —à–≤–∏–¥–∫–µ (native), —Å–∫–ª–∞–¥–Ω–∏—Ö/–Ω–µ—Å—É–º—ñ—Å–Ω–∏—Ö ‚Äî –Ω–∞–¥—ñ–π–Ω–µ (GUI + vision).
- Project Atlas –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ —Ä—ñ–≤–Ω—è "desktop agent" —è–∫ —É Anthropic Computer Use, –∞–ª–µ –∑ —Ñ–æ–∫—É—Å–æ–º –Ω–∞ macOS.

## –¢–µ—Ä–º—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó (–æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ)
- –ï—Ç–∞–ø 1 (tools + native): 3‚Äì5 –¥–Ω—ñ–≤.
- –ï—Ç–∞–ø 2 (fallback –ª–æ–≥—ñ–∫–∞ + –ø—Ä–æ–º–ø—Ç–∏): 4‚Äì7 –¥–Ω—ñ–≤.
- –ï—Ç–∞–ø 3 (vision verification + –±–µ–∑–ø–µ–∫–∞): 5‚Äì7 –¥–Ω—ñ–≤.
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Å—Ç–∞–±—ñ–ª—ñ–∑–∞—Ü—ñ—è: 5 –¥–Ω—ñ–≤.

–ì–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∑ –∫–æ–¥–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö tool-—ñ–≤ –∞–±–æ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏ –ø—Ä–æ–º–ø—Ç—ñ–≤. –¶–µ –±—É–¥–µ –ø–æ—Ç—É–∂–Ω–∏–π –∞–ø–≥—Ä–µ–π–¥ —Å–∏—Å—Ç–µ–º–∏! üöÄ